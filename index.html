<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notion Custom Dashboard</title>
    <style>
        :root {
            --bg-color: #FFFFFF;
            --text-color: #37352F;
            --accent-color: #E3E2E0; /* Notion Gray */
            --bar-fill: #37352F;
            --font-stack: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #191919;
                --text-color: #D4D4D4;
                --accent-color: #2F2F2F;
                --bar-fill: #D4D4D4;
            }
        }

        body {
            font-family: var(--font-stack);
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 1rem;
            box-sizing: border-box;
        }

        /* Container for all widgets */
        #dashboard {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Generic Card Styling */
        .widget-card {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .widget-header {
            font-size: 0.85rem;
            font-weight: 600;
            opacity: 0.6;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .widget-content {
            font-size: 1rem;
        }

        /* Error state */
        .error { color: red; font-size: 0.8rem; }
    </style>
</head>
<body>

    <div id="dashboard"></div>

    <script>
        // --- 1. DEFAULT CONFIGURATION (The "State") ---
        // Eventually, this will be loaded from the URL. 
        // For now, we manually define it to test our structure.
        const defaultConfig = [
            {
                id: 'w1',
                type: 'clock',
                title: 'Home Base',
                settings: { timezone: 'local', showSeconds: false }
            },
            {
                id: 'w2',
                type: 'progress_temporal',
                title: 'Year Progress',
                settings: { period: 'year' }
            },
            {
                id: 'w3',
                type: 'world_clock',
                title: 'Team Locations',
                settings: { 
                    locations: [
                        { label: 'New York', timezone: 'America/New_York' },
                        { label: 'London', timezone: 'Europe/London' }
                    ]
                }
            }
        ];

        // --- 2. THE RENDER ENGINE ---
        function renderDashboard(config) {
            const container = document.getElementById('dashboard');
            container.innerHTML = ''; // Clear current

            config.forEach(widget => {
                const widgetEl = document.createElement('div');
                widgetEl.className = 'widget-card';
                widgetEl.id = widget.id;

                // Create Header
                if (widget.title) {
                    const header = document.createElement('div');
                    header.className = 'widget-header';
                    header.innerText = widget.title;
                    widgetEl.appendChild(header);
                }

                // Create Content Container
                const content = document.createElement('div');
                content.className = 'widget-content';
                
                // Route to specific widget renderers
                try {
                    if (widget.type === 'clock') renderClock(content, widget.settings);
                    else if (widget.type === 'progress_temporal') renderPlaceholder(content, 'Progress Bar (Coming Soon)');
                    else if (widget.type === 'world_clock') renderPlaceholder(content, 'World Clock List (Coming Soon)');
                    else renderPlaceholder(content, `Unknown Widget: ${widget.type}`);
                } catch (e) {
                    content.innerHTML = `<span class="error">Error loading widget</span>`;
                    console.error(e);
                }

                widgetEl.appendChild(content);
                container.appendChild(widgetEl);
            });
        }

        // --- 3. COMPONENT LOGIC (Basic) ---

        function renderPlaceholder(container, text) {
            container.innerHTML = `<div style="padding: 10px; background: var(--accent-color); border-radius: 4px;">${text}</div>`;
        }

        function renderClock(container, settings) {
            const timeEl = document.createElement('div');
            timeEl.style.fontSize = '2.5rem';
            timeEl.style.fontWeight = '700';
            
            function tick() {
                const now = new Date();
                timeEl.innerText = now.toLocaleTimeString([], { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    second: settings.showSeconds ? '2-digit' : undefined 
                });
            }
            
            tick();
            setInterval(tick, 1000);
            container.appendChild(timeEl);
        }

        // --- 4. INITIALIZATION ---
        // In the future, we will check URL params here.
        renderDashboard(defaultConfig);

    </script>
</body>
</html>
